#lang pyramid

(require psl "arith.pmd")
(require psl "syntax.pmd")

(defmacro (__builtin_set_test_result n)
  `(set-test-result! ,n))

(defmacro (%c--- x)
  `(begin (set! ,x (- ,x 1))
          ,x))

(defmacro (%c-++ x)
  `(begin (set! ,x (+ ,x 1))
          ,x))

(defmacro (%c-== x y) `(= ,x ,y))
(defmacro (%c-> x y) `(> ,x ,y))

(defmacro (%c-*= x y)
  `(begin (set! ,x (* ,x ,y))
          ,x))

(defmacro (%c-loop-forever body)
  `((Î» ()
      (define (loop) ,body (loop))
      (loop))))
